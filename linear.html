<!DOCTYPE html>
<html lang="en">
<head>
    <script src="micro_grad.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas Drawing</title>
    <style>
        canvas {
            border: 1px solid black;
        }
    </style>
</head>
<body>
    <canvas id="myCanvas" width="500" height="500"></canvas>

    <script>
        const canvas = document.getElementById('myCanvas');
        const ctx = canvas.getContext('2d');
        const data = [
            [0.1,0.2],
            [0.2,0.45],
            [0.3,0.65],
            [0.4,0.8],
            [0.5,0.95]
            // Add more initial points here if needed
        ];
        // const data = [
        //     [1,2],
        //     [2,4.5],
        //     [3,6.5],
        //     [4,8],
        //     [5,9.5]
        //     // Add more initial points here if needed
        // ];

        let w = canvas.width;
        let h = canvas.height;

        function convert2train_data(data){
            let x = []
            let y = []
            for(let o of data){
                x.push(o[0]);
                y.push(o[1]);
            }
            return [x,y];
        }


        train_xy = convert2train_data(data)
        tx = train_xy[0]
        ty = train_xy[1]
        model = train_linear(tx,ty)



        function drawPoints(data,color,r) {
            // ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear the canvas
            data.forEach(point => {
                ctx.fillStyle = color;
                ctx.beginPath();
                ctx.arc(point[0] * w, point[1] * h, r, 0, Math.PI * 2);
                ctx.fill();
            });
        }



        // Initial drawing
        drawPoints(data,'red',10);
        let _data = [];
        let N = w;
        for(let i=0;i<N;i++){
            let x = i / N;
            let y = model.forward([x]);
            _data.push([x,y[0].data]);
        }
        // console.log(_data);

        drawPoints(_data,'black',1);

        // Function to handle canvas click event
        canvas.addEventListener('click', function(event) {
            const rect = canvas.getBoundingClientRect();
            const x = (event.clientX - rect.left)/w;
            const y = (event.clientY - rect.top)/h;
            const color = 'black'; // Default color for new points
            data.push({x, y, color});
            drawPoints(); // Redraw the canvas with the new point
        });
    </script>
</body>
</html>
